imhere.TwitterAPI=function(e,t){this.consumer={consumerKey:"QS31zTayk8JraIqyEMpqYNKpM",consumerSecret:"vTWbyyXbIFgQnOH65TPlGzdmXzVvHodewttw5HH00xqCVEDShQ"},this.token="",this.token_secret="",this.atoken=e,this.atoken_secret=t},imhere.TwitterAPI.prototype.isAvailable=function(){var e;return this.atoken!==e?!0:!1},imhere.TwitterAPI.prototype.getRequestToken=function(){var e=new $.Deferred,t={consumerSecret:this.consumer.consumerSecret,tokenSecret:""},r={method:"GET",action:"https://twitter.com/oauth/request_token",parameters:{oauth_callback:"http://127.0.0.1/imhere/index.html",oauth_consumer_key:this.consumer.consumerKey,oauth_signature_method:"HMAC-SHA1"}};OAuth.setTimestampAndNonce(r),OAuth.SignatureMethod.sign(r,t);var o=OAuth.addToURL(r.action,r.parameters),n=this,s={type:r.method,url:o,success:function(t){t.search(/oauth_token=([\w-]+)\&/),n.token=RegExp.$1,t.search(/oauth_token_secret=([\w-]+)\&/),n.token_secret=RegExp.$1,e.resolve()},error:function(t){e.reject(t)}};return $.ajax(s),e.promise()},imhere.TwitterAPI.prototype.userAuthentication=function(){function e(e){var r=e.url,o=imhere.utils.getUrlVars(e.url).oauth_token,a=imhere.utils.getUrlVars(e.url).oauth_verifier;a!==s?(n.close(),t.resolve(o,a)):-1!=r.indexOf("http://127.0.0.1/imhere/index.html")?(n.close(),t.resolve(o,a)):-1!=r.indexOf("cancel")&&(n.close(),t.resolve(o,a))}var t=new $.Deferred,r={consumerSecret:this.consumer.consumerSecret,tokenSecret:this.token_secret},o={method:"GET",action:"https://twitter.com/oauth/authorize",parameters:{oauth_signature_method:"HMAC-SHA1",oauth_consumer_key:this.consumer.consumerKey,oauth_token:this.token,force_login:"false"}};OAuth.setTimestampAndNonce(o),OAuth.SignatureMethod.sign(o,r);var n,s,a=OAuth.addToURL(o.action,o.parameters),i={type:o.method,url:a,success:function(){}};return n=window.open(i.url,"_blank","location=no"),n.addEventListener("loadstart",e),t.promise()},imhere.TwitterAPI.prototype.getAccessToken=function(e,t){var r=new $.Deferred,o={consumerSecret:this.consumer.consumerSecret,tokenSecret:this.token_secret},n={method:"GET",action:"https://twitter.com/oauth/access_token",parameters:{oauth_signature_method:"HMAC-SHA1",oauth_consumer_key:this.consumer.consumerKey,oauth_token:e,oauth_verifier:t}};OAuth.setTimestampAndNonce(n),OAuth.SignatureMethod.sign(n,o);var s=OAuth.addToURL(n.action,n.parameters),a=this,i={type:n.method,url:s,success:function(e){e.search(/oauth_token=([\w-]+)\&/),a.atoken=RegExp.$1,e.search(/oauth_token_secret=([\w-]+)\&/),a.atoken_secret=RegExp.$1,r.resolve(a.atoken,a.atoken_secret)},error:function(e){r.reject(e)}};return $.ajax(i),r.promise()},imhere.TwitterAPI.prototype.post=function(e,t,r){var o={consumerSecret:this.consumer.consumerSecret,tokenSecret:this.atoken_secret},n={method:"POST",action:e,parameters:{oauth_signature_method:"HMAC-SHA1",oauth_consumer_key:this.consumer.consumerKey,oauth_token:this.atoken}};for(var s in t)n.parameters[s]=t[s];OAuth.setTimestampAndNonce(n),OAuth.SignatureMethod.sign(n,o);var a=OAuth.addToURL(n.action,n.parameters),i={type:n.method,url:a,dataType:"json",success:function(e,t){r.resolve(e,t)},error:function(e){r.reject(e)}};return $.ajax(i),r},imhere.TwitterAPI.prototype.updateStatus=function(e,t,r){var o=new $.Deferred,n={status:e,source:"metoro",lat:t.latitude,"long":t.longitude};return""!==r&&(n.in_reply_to_status_id=r),this.post("https://api.twitter.com/1.1/statuses/update.json",n,o),o.promise()},imhere.TwitterAPI.prototype.search=function(e,t,r){var o={consumerSecret:this.consumer.consumerSecret,tokenSecret:this.atoken_secret},n={method:"GET",action:"https://api.twitter.com/1.1/search/tweets.json",parameters:{oauth_signature_method:"HMAC-SHA1",oauth_consumer_key:this.consumer.consumerKey,oauth_token:this.atoken}};for(var s in t)n.parameters[s]=t[s];OAuth.setTimestampAndNonce(n),OAuth.SignatureMethod.sign(n,o);var a=OAuth.addToURL(n.action,n.parameters),i={type:n.method,url:a,dataType:"json",success:function(e){r.resolve(e)},error:function(e){r.reject(e)}};return $.ajax(i),r},imhere.TwitterAPI.prototype.searchAllTweets=function(){var e=new $.Deferred;query="%23imhereintyo";var t={q:query,count:100,result_type:"recent"};return this.search("https://api.twitter.com/1.1/search/tweets.json",t,e),e.promise()},imhere.TwitterAPI.prototype.initAPI=function(){var e;this.token="",this.token_secret="",this.atoken=e,this.atoken_secret=e};